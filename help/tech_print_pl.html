<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="generator" content="WebSite PRO 4.3" />
  <title>Ant Movie Catalog Help</title>
       <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" />
       <link rel="stylesheet" href="main.css" type="text/css" />
</head>
<body>
<p class="title">Tworzenie raportów (wzorców do drukowania)</p>
<hr />
<p> UWAGA: PROJEKTANT RAPORTÓW JEST PO ANGIELSKU, POZOSTAWIAM ORYGINALNE NAZWY ABY U£ATWIÆ PRACÊ (t³.)</p>
<p>¯eby uruchomiæ "Projektanta raportów" kliknij na przycisku "Projektant..." w oknie drukowania.
   Mo¿esz tak¿e u¿yæ skrótu, który zosta³ dodany do menu Start lub uruchomiæ AMCReport.exe,
   który znajduje siê w tym samym folderze co Ant Movie Catalog.</p>
<p>"Projektant raportów" jest w³a¶ciwie edytorem FreeReport i nie uleg³ praktycznie ¿adnej modyfikacji
   (jest raczej z³o¿ony, wiêc prawdopodobnie zostawiê go w tej postaci w jakiej jest).</p>
<p>Ta strona poka¿e ró¿ne sposoby tworzenia raportu.</p>
<hr />

<p class="subtitle">Wybór rozmiaru papieru.</p>
<p>File -> Page Options - wybór rozmiaru papieru. Zazwyczaj bêdzie to A4 (lub Letter).
   Je¶li chcesz, to mo¿esz tak¿e wybraæ orientacjê poziom± (Landscape) zamiast pionowej (Portrait).</p>

<p class="subtitle">Ramki</p>
<p>¯eby pola zosta³y rozpoznane musz± byæ umieszczone w "Ramkach". Aby umie¶ciæ ramkê na stronie,
   kliknij na ikonie <i>Insert band</i> <img src="img/print_band.png" alt="Insert band (Wstaw ramkê)" />, a nastêpnie na stronie,
   gdzie chcesz umie¶ciæ t± ramkê. Nastêpnie mo¿esz wybraæ jaki typ ramki chcesz umie¶ciæ:</p>
<p><img src="img/print_bandtype.png" alt="Insert band type (Typ strefy)" /></p>
<p>Wiêkszo¶æ typów nie ma zastosowania. Te, które mo¿esz u¿yæ s± nastêpuj±ce:</p>
<ul>
  <li><i>Report title &amp; Report summary</i> : &nbsp;&nbsp;Pojawiaj± siê jedynie na pierwszej stronie (Tytu³ i Podsumowanie raportu)</li>
  <li><i>Page header &amp; Page footer</i> :&nbsp;&nbsp; Nag³ówek i stopka ka¿dej strony</li>
  <li><i>Master data</i> : &nbsp;&nbsp;Jest to najwa¿niejsza ramka. Jako jedyna bêdzie powtarzana dla ka¿dego filmu</li>
</ul>
<p>Wybierz "Master data" i kliknij "OK". Kolejne okno poprosi o wybranie ¼ród³a, zostaw domy¶lne ("None") i kliknij "OK".</p>

<p class="subtitle">Obiekty tekstowe</p>
<p>Aby umie¶ciæ obiekt tekstowy na ramce "Master data", wybierz ikonê <i>Insert rectangle object</i>
  <img src="img/print_rectangle.png" alt="Insert rectangle object" /> i umie¶æ na ramce (uwaga: je¶li umie¶cisz poza ni±, nie pojawi siê ono w koñcowym raporcie).</p>
<p>Wy¶wietli siê edytor tekstu:</p>
<p><img src="img/print_texteditor.png" alt="Text editor" /></p>
<p>Mo¿esz tu wpisaæ jakikolwiek tekst i klikn±æ "OK". Aby wywo³aæ to okno ponownie, po prostu dwukrotnie kliknij na obiekcie.</p>
<p>W menu kontekstowym (prawy klik) tego pola tekstowego s± trzy opcje:</p>
<ul>
  <li><i>Stretched</i> &nbsp;&nbsp;: Powiêksza wysoko¶æ pola, je¶li to bêdzie konieczne</li>
  <li><i>Word wrap</i> : Zawija wiersze je¶li s± d³u¿sze, ni¿ pole.</li>
  <li><i>Autosiz</i>e &nbsp;&nbsp;: Powiêksza szeroko¶æ pola, je¶li to konieczne.</li>
</ul>

<p class="subtitle">Zmienne (pola filmów i inne)</p>
<p>¯eby umie¶ciæ pole filmu, dodaj obiekt tekstowy, we w³a¶ciwo¶ciach ustaw nazwê pola pomiêdzy [ ]. Lista nazw pól jest dostêpna za pomoc± przycisku "Variable" jako "Movie fields" w oknie Edytora tekstu :</p>
<p><img src="img/print_variables.png" alt="Zmienne" /></p>
<p>Nazwy pól mog± byæ równie¿ wydrukowane przy u¿yciu zmiennych. Aby tego dokonaæ musisz dopisaæ prefiks "label:" przed nazw± pola, ca³a nazwa i prefiks powinny byæ w nawiasie kwadratowym (np. [label:Director]). Dostêpne jako "Field labels" w "Variable". Jest to u¿yteczne przy tworzeniu wielojêzycznych raportów (wstawione zostan± nazwy w jêzyku, jaki jest ustawiony w programie)</p>
<p>Je¶li zmienisz kategoriê na "Others" bêdziesz móg³ wybraæ pola specjalne takie jak:
   numer strony, data, itp...</p>
<p>Mo¿esz wprowadziæ normalny tekst i zmienne w tym samym obiekcie tekstowym.</p>

<p class="subtitle">Grafika</p>
<p>Aby umie¶ciæ obrazek, u¿yj ikony <i>Insert picture </i><img src="img/print_picture.png" alt="picture" />.
Okno obrazka wygl±da tak:</p>
<p><img src="img/print_picturewin.png" alt="Picture" /></p>
<p>Aby wy¶wietla³o ono ok³adkê bie¿±cego filmu, kliknij na przycisk "Memo" i wpisz "[Picture]" lub wybierz z listy zmiennych ("Variable").</p>
<p>W menu kontekstowym okna obrazka, s± trzy opcje:</p>
<ul>
  <li><i>Stretched</i> :&nbsp;&nbsp; dopasowuje obrazek, aby pasowa³ do rozmiaru obiektu</li>
  <li><i>Center picture</i> : &nbsp;&nbsp;ustawia obrazek po¶rodku obiektu</li>
  <li><i>Keep aspect ratio</i> : &nbsp;&nbsp;zachowuje proporcje obrazka podczas dopasowania</li>
</ul>
<p>Mo¿esz tak¿e rysowaæ linie u¿ywaj±c ikony <i>Draw line</i> <img src="img/print_lines.png" alt="lines" />.</p>
<p class="subtitle">Skrypty</p>
<p>W oknie edytora tekstu oraz okna obrazka (po wej¶ciu w Memo) jest u góry opcja "Script". Po jej zaznaczeniu otworzy siê u do³u okno w którym mo¿na wprowadziæ komendy skryptu. Skrypt ten nie jest zwi±zany z tymi u¿ywanymi przez Ant Movie Catalog, poza u¿yciem tego samego jêzyka programowania - Pascala. Oto kilka przyk³adów:</p>
<ul>
  <li><p>Je¶li chcesz aby obrazek pojawia³ siê tylko dla filmów komediowych, umie¶æ nastêpuj±cy kod w skrypcie w czê¶ci Memo obrazka:</p>
<pre>begin
  Visible := [Category] = 'Komedia';
end;</pre>
  Uwaga: kategoria jest uwzglêdniana tylko w ca³o¶ci i dok³adnie; w powy¿szym przyk³adzie nie zostanie uwzglêdniona np. "Komedia / Wojenny" ani "komedia".<br>
  </li>
  <li><p>Je¶li chcesz umie¶ciæ rok w nawiasach po tytule filmu tylko, gdy zosta³ on podany (aby unikn±æ wstawienia pustych nawiasów) wykorzystaj poni¿szy skrypt w oknie edytora tekstu:</p>
<pre>begin
if ([Year] &lt;&gt; '') then
  tmp1 := [OriginalTitle] + ' (' + [Year] + ')'
else
  tmp1 := [OriginalTitle]
end;</pre>
  <p>Za¶ w oknie edytora umie¶æ <code>[tmp1]</code>, aby wy¶wietliæ wynik skryptu jako now± zmienn±.</p>
  </li>
</ul>
<p>Oto lista niektórych podstawowych funkcji dostêpnych dla skryptów:</p>
<ul>
  <li><p><code>Length(&lt;string&gt;)</code>: Zwraca d³ugo¶æ ³añcucha.</p></li>
  <li><p><code>Pos(&lt;substring&gt;, &lt;string&gt;)</code>: Zwraca pierwsz± pozycjê podci±gu w ci±gu znaków (tak samo jak funkcja Delphi).</p></li>
  <li><p><code>LastPos(&lt;substring&gt;, &lt;string&gt;)</code>: Zwraca ostatni± pozycjê podci±gu w ci±gu znaków.</p></li>
  <li><p><code>Copy(&lt;string&gt;, &lt;from&gt;, &lt;count&gt;)</code>: Zwraca czê¶æ ci±gu (tak samo jak funkcja Delphi).</p></li>
  <li><p><code>StringReplace(&lt;s&gt;, &lt;old&gt;, &lt;new&gt;)</code>: zastêpuje stary ci±g nowym w ci±gu s (wielkie litery).</p></li>
  <li><p><code>StringReplaceIgnoreCase(&lt;s&gt;, &lt;old&gt;, &lt;new&gt;)</code>: Taka sama jak StringReplace, ale bez wielkich liter.</p></li>
  <li><p><code>RegExprSetSubstitute(&lt;ExprStr&gt;, &lt;InputStr&gt;, &lt;TemplateStr&gt;)</code>: Zwraca ci±g TemplateStr z warto¶ciami '$&' lub '$0' zastêpuje wszystkie wystêpuj±ce i zamienia wystêpuj±ce '$n' na podwyra¿enie #n.</p></li>
  <li><p><code>RegExprSetReplace(&lt;ExprStr&gt;, &lt;InputStr&gt;, &lt;ReplaceStr&gt;)</code>: Zwraca ci±g wyst±pienia InputStr i zamienia na ci±g ReplaceStr (z wykorzystaniem podstawiania).</p></li>
  <li><p><code>RegExprSetReplaceSimple(&lt;ExprStr&gt;, &lt;InputStr&gt;, &lt;ReplaceStr&gt;)</code>: Zwraca ci±g wyst±pienia InputStr i zamienia na ci±g ReplaceStr (bez wykorzystywania podstawiania).</p></li>
  <li><p><code>UpperCase(&lt;string&gt;)</code>: Zmienia wszystkie litery ci±gu na wielkie litery.</p></li>
  <li><p><code>LowerCase(&lt;string&gt;)</code>: Zmienia wszystkie litery ci±gu na ma³e litery.</p></li>
  <li><p><code>NameCase(&lt;string&gt;)</code>: Zmienia wszystkie litery ci±gu na ma³e, z wyj±tkiem pierwszej litery.</p></li>

  <li><p><code>Str(&lt;value&gt;)</code>: Konwertuje liczbê na ci±g znaków.</p></li>
  <li><p><code>FormatFloat(&lt;formatstr&gt;, &lt;value&gt;)</code>: Konwertuje warto¶æ numeryczn± na ci±g z wykorzystaniem maski w formatstr (taki sam format jak w Delphi).</p></li>
  <li><p><code>FormatDateTime(&lt;formatstr&gt;, &lt;value&gt;)</code>: Konwertuje datê/czas na ci±g znaków z wykorzystaniem maski w formatstr (taki sam format jak w Delphi).</p></li>
  <li><p><code>StrToDate(&lt;string&gt;)</code>: Konwertuje ci±g znaków na datê.</p></li>
  <li><p><code>StrToTime(&lt;string&gt;)</code>: Konwertuje ci±g znaków na czas.</p></li>

  <li><p><code>Int(&lt;value&gt;)</code>: Zwraca liczbê ca³kowit±.</p></li>
  <li><p><code>Frac(&lt;value&gt;)</code>: Zwraca u³amek liczby.</p></li>
  <li><p><code>Round(&lt;value&gt;)</code>: Zwraca zaokr±glon± warto¶æ liczby.</p></li>
  <li><p><code>value1 Mod value2</code>: Zwraca resztê z dzielenia value1 / value2.</p></li>

  <li><p><code>DATE</code>: Zwraca aktualn± datê.</p></li>
  <li><p><code>TIME</code>: Zwraca aktualny czas.</p></li>
  <li><p><code>PAGE#</code>: Zwraca aktualny numer strony.</p></li>
  <li><p><code>TOTALPAGES</code>: Zwraca ca³kowit± liczbê stron w utworzonym raporcie. Aby korzystaæ z tej opcji, raport musi mieæ aktywowan± funkcjê "Two pass report".</p></li>
</ul>
<hr />
<p>Wiele funkcji Projektanta Raportów nie jest wykorzystanych, jak np. pola DB, podgl±d wydruku, podraporty...<br>
Obecnie jedyn± metod± podgl±du wydruku jest zapisanie wzorca i u¿ycie "Od¶wie¿" w oknie Ant Movie Catalog, oczywi¶cie po wskazaniu zapisanego wzorca z listy.</p>
<p>W przypadku problemów z polami filmu, upewnij siê, ¿e s± one umieszczone na ramce "Master data". Je¶li niektóre pola nie dzia³aj± (np. "Total pages"), sprawd¼ czy zaznaczone jest "Two pass report" w File -&gt; Report Options.</p>
</body>
</html>
