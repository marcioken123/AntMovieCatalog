(***************************************************

Ant Movie Catalog importation script
www.antp.be/software/moviecatalog/

[Infos]
Authors=Dekert
Title=cp1250
Description=Code page 1250 conversion functions
Site=
Language=?
Version=1.0 (06.04.2019)
Requires=3.5
Comments=
License=This program is free software; you can redistribute it and/or modify it under the  terms of the GNU General Public License as published by the Free Software Foundation;  either version 2 of the License, or (at your option) any later version.
GetInfo=0
RequiresMovies=0

[Options]

[Parameters]

***************************************************)
unit cp1250;
  
function UTF8ToCP1250(str: string): string;
var s: string;
begin
  s := str;
  s := StringReplace(s, #194#129, #129);         // <control>
  s := StringReplace(s, #194#131, #131);         // <control>
  s := StringReplace(s, #194#136, #136);         // <control>
  s := StringReplace(s, #194#144, #144);         // <control>
  s := StringReplace(s, #194#152, #152);         // <control>
  s := StringReplace(s, #194#160, #160);         // No-Break Space
  s := StringReplace(s, #194#161, #33);          // Inverted Exclamation Mark
  s := StringReplace(s, #194#162, #99);          // Cent Sign
  s := StringReplace(s, #194#163, #76);          // Pound Sign
  s := StringReplace(s, #194#164, #164);         // Currency Sign
  s := StringReplace(s, #194#165, #89);          // Yen Sign
  s := StringReplace(s, #194#166, #166);         // Broken Bar
  s := StringReplace(s, #194#167, #167);         // Section Sign
  s := StringReplace(s, #194#168, #168);         // Diaeresis
  s := StringReplace(s, #194#169, #169);         // Copyright Sign
  s := StringReplace(s, #194#170, #97);          // Feminine Ordinal Indicator
  s := StringReplace(s, #194#171, #171);         // Left-Pointing Double Angle Quotation Mark
  s := StringReplace(s, #194#172, #172);         // Not Sign
  s := StringReplace(s, #194#173, #173);         // Soft Hyphen
  s := StringReplace(s, #194#174, #174);         // Registered Sign
  s := StringReplace(s, #194#175, #151);         // Macron
  s := StringReplace(s, #194#176, #176);         // Degree Sign
  s := StringReplace(s, #194#177, #177);         // Plus-Minus Sign
  s := StringReplace(s, #194#178, #50);          // Superscript Two
  s := StringReplace(s, #194#179, #51);          // Superscript Three
  s := StringReplace(s, #194#180, #180);         // Acute Accent
  s := StringReplace(s, #194#181, #181);         // Micro Sign
  s := StringReplace(s, #194#182, #182);         // Pilcrow Sign
  s := StringReplace(s, #194#183, #183);         // Middle Dot
  s := StringReplace(s, #194#184, #184);         // Cedilla
  s := StringReplace(s, #194#185, #49);          // Superscript One
  s := StringReplace(s, #194#186, #111);         // Masculine Ordinal Indicator
  s := StringReplace(s, #194#187, #187);         // Right-Pointing Double Angle Quotation Mark
  s := StringReplace(s, #194#188, #49);          // Vulgar Fraction One Quarter
  s := StringReplace(s, #194#189, #49);          // Vulgar Fraction One Half
  s := StringReplace(s, #194#190, #51);          // Vulgar Fraction Three Quarters
  s := StringReplace(s, #194#191, #63);          // Inverted Question Mark
  s := StringReplace(s, #195#128, #65);          // Latin Capital Letter A With Grave
  s := StringReplace(s, #195#129, #193);         // Latin Capital Letter A With Acute
  s := StringReplace(s, #195#130, #194);         // Latin Capital Letter A With Circumflex
  s := StringReplace(s, #195#131, #65);          // Latin Capital Letter A With Tilde
  s := StringReplace(s, #195#132, #196);         // Latin Capital Letter A With Diaeresis
  s := StringReplace(s, #195#133, #65);          // Latin Capital Letter A With Ring Above
  s := StringReplace(s, #195#134, #65);          // Latin Capital Ligature Ae
  s := StringReplace(s, #195#135, #199);         // Latin Capital Letter C With Cedilla
  s := StringReplace(s, #195#136, #69);          // Latin Capital Letter E With Grave
  s := StringReplace(s, #195#137, #201);         // Latin Capital Letter E With Acute
  s := StringReplace(s, #195#138, #69);          // Latin Capital Letter E With Circumflex
  s := StringReplace(s, #195#139, #203);         // Latin Capital Letter E With Diaeresis
  s := StringReplace(s, #195#140, #73);          // Latin Capital Letter I With Grave
  s := StringReplace(s, #195#141, #205);         // Latin Capital Letter I With Acute
  s := StringReplace(s, #195#142, #206);         // Latin Capital Letter I With Circumflex
  s := StringReplace(s, #195#143, #73);          // Latin Capital Letter I With Diaeresis
  s := StringReplace(s, #195#145, #78);          // Latin Capital Letter N With Tilde
  s := StringReplace(s, #195#146, #79);          // Latin Capital Letter O With Grave
  s := StringReplace(s, #195#147, #211);         // Latin Capital Letter O With Acute
  s := StringReplace(s, #195#148, #212);         // Latin Capital Letter O With Circumflex
  s := StringReplace(s, #195#149, #79);          // Latin Capital Letter O With Tilde
  s := StringReplace(s, #195#150, #214);         // Latin Capital Letter O With Diaeresis
  s := StringReplace(s, #195#151, #215);         // Multiplication Sign
  s := StringReplace(s, #195#152, #79);          // Latin Capital Letter O With Stroke
  s := StringReplace(s, #195#153, #85);          // Latin Capital Letter U With Grave
  s := StringReplace(s, #195#154, #218);         // Latin Capital Letter U With Acute
  s := StringReplace(s, #195#155, #85);          // Latin Capital Letter U With Circumflex
  s := StringReplace(s, #195#156, #220);         // Latin Capital Letter U With Diaeresis
  s := StringReplace(s, #195#157, #221);         // Latin Capital Letter Y With Acute
  s := StringReplace(s, #195#159, #223);         // Latin Small Letter Sharp S
  s := StringReplace(s, #195#160, #97);          // Latin Small Letter A With Grave
  s := StringReplace(s, #195#161, #225);         // Latin Small Letter A With Acute
  s := StringReplace(s, #195#162, #226);         // Latin Small Letter A With Circumflex
  s := StringReplace(s, #195#163, #97);          // Latin Small Letter A With Tilde
  s := StringReplace(s, #195#164, #228);         // Latin Small Letter A With Diaeresis
  s := StringReplace(s, #195#165, #97);          // Latin Small Letter A With Ring Above
  s := StringReplace(s, #195#166, #97);          // Latin Small Ligature Ae
  s := StringReplace(s, #195#167, #231);         // Latin Small Letter C With Cedilla
  s := StringReplace(s, #195#168, #101);         // Latin Small Letter E With Grave
  s := StringReplace(s, #195#169, #233);         // Latin Small Letter E With Acute
  s := StringReplace(s, #195#170, #101);         // Latin Small Letter E With Circumflex
  s := StringReplace(s, #195#171, #235);         // Latin Small Letter E With Diaeresis
  s := StringReplace(s, #195#172, #105);         // Latin Small Letter I With Grave
  s := StringReplace(s, #195#173, #237);         // Latin Small Letter I With Acute
  s := StringReplace(s, #195#174, #238);         // Latin Small Letter I With Circumflex
  s := StringReplace(s, #195#175, #105);         // Latin Small Letter I With Diaeresis
  s := StringReplace(s, #195#177, #110);         // Latin Small Letter N With Tilde
  s := StringReplace(s, #195#178, #111);         // Latin Small Letter O With Grave
  s := StringReplace(s, #195#179, #243);         // Latin Small Letter O With Acute
  s := StringReplace(s, #195#180, #244);         // Latin Small Letter O With Circumflex
  s := StringReplace(s, #195#181, #111);         // Latin Small Letter O With Tilde
  s := StringReplace(s, #195#182, #246);         // Latin Small Letter O With Diaeresis
  s := StringReplace(s, #195#183, #247);         // Division Sign
  s := StringReplace(s, #195#184, #111);         // Latin Small Letter O With Stroke
  s := StringReplace(s, #195#185, #117);         // Latin Small Letter U With Grave
  s := StringReplace(s, #195#186, #250);         // Latin Small Letter U With Acute
  s := StringReplace(s, #195#187, #117);         // Latin Small Letter U With Circumflex
  s := StringReplace(s, #195#188, #252);         // Latin Small Letter U With Diaeresis
  s := StringReplace(s, #195#189, #253);         // Latin Small Letter Y With Acute
  s := StringReplace(s, #195#191, #121);         // Latin Small Letter Y With Diaeresis
  s := StringReplace(s, #196#128, #65);          // Latin Capital Letter A With Macron
  s := StringReplace(s, #196#129, #97);          // Latin Small Letter A With Macron
  s := StringReplace(s, #196#130, #195);         // Latin Capital Letter A With Breve
  s := StringReplace(s, #196#131, #227);         // Latin Small Letter A With Breve
  s := StringReplace(s, #196#132, #165);         // Latin Capital Letter A With Ogonek
  s := StringReplace(s, #196#133, #185);         // Latin Small Letter A With Ogonek
  s := StringReplace(s, #196#134, #198);         // Latin Capital Letter C With Acute
  s := StringReplace(s, #196#135, #230);         // Latin Small Letter C With Acute
  s := StringReplace(s, #196#136, #67);          // Latin Capital Letter C With Circumflex
  s := StringReplace(s, #196#137, #99);          // Latin Small Letter C With Circumflex
  s := StringReplace(s, #196#138, #67);          // Latin Capital Letter C With Dot Above
  s := StringReplace(s, #196#139, #99);          // Latin Small Letter C With Dot Above
  s := StringReplace(s, #196#140, #200);         // Latin Capital Letter C With Caron
  s := StringReplace(s, #196#141, #232);         // Latin Small Letter C With Caron
  s := StringReplace(s, #196#142, #207);         // Latin Capital Letter D With Caron
  s := StringReplace(s, #196#143, #239);         // Latin Small Letter D With Caron
  s := StringReplace(s, #196#144, #208);         // Latin Capital Letter D With Stroke
  s := StringReplace(s, #196#145, #240);         // Latin Small Letter D With Stroke
  s := StringReplace(s, #196#146, #69);          // Latin Capital Letter E With Macron
  s := StringReplace(s, #196#147, #101);         // Latin Small Letter E With Macron
  s := StringReplace(s, #196#148, #69);          // Latin Capital Letter E With Breve
  s := StringReplace(s, #196#149, #101);         // Latin Small Letter E With Breve
  s := StringReplace(s, #196#150, #69);          // Latin Capital Letter E With Dot Above
  s := StringReplace(s, #196#151, #101);         // Latin Small Letter E With Dot Above
  s := StringReplace(s, #196#152, #202);         // Latin Capital Letter E With Ogonek
  s := StringReplace(s, #196#153, #234);         // Latin Small Letter E With Ogonek
  s := StringReplace(s, #196#154, #204);         // Latin Capital Letter E With Caron
  s := StringReplace(s, #196#155, #236);         // Latin Small Letter E With Caron
  s := StringReplace(s, #196#156, #71);          // Latin Capital Letter G With Circumflex
  s := StringReplace(s, #196#157, #103);         // Latin Small Letter G With Circumflex
  s := StringReplace(s, #196#158, #71);          // Latin Capital Letter G With Breve
  s := StringReplace(s, #196#159, #103);         // Latin Small Letter G With Breve
  s := StringReplace(s, #196#160, #71);          // Latin Capital Letter G With Dot Above
  s := StringReplace(s, #196#161, #103);         // Latin Small Letter G With Dot Above
  s := StringReplace(s, #196#162, #71);          // Latin Capital Letter G With Cedilla
  s := StringReplace(s, #196#163, #103);         // Latin Small Letter G With Cedilla
  s := StringReplace(s, #196#164, #72);          // Latin Capital Letter H With Circumflex
  s := StringReplace(s, #196#165, #104);         // Latin Small Letter H With Circumflex
  s := StringReplace(s, #196#166, #72);          // Latin Capital Letter H With Stroke
  s := StringReplace(s, #196#167, #104);         // Latin Small Letter H With Stroke
  s := StringReplace(s, #196#168, #73);          // Latin Capital Letter I With Tilde
  s := StringReplace(s, #196#169, #105);         // Latin Small Letter I With Tilde
  s := StringReplace(s, #196#170, #73);          // Latin Capital Letter I With Macron
  s := StringReplace(s, #196#171, #105);         // Latin Small Letter I With Macron
  s := StringReplace(s, #196#172, #73);          // Latin Capital Letter I With Breve
  s := StringReplace(s, #196#173, #105);         // Latin Small Letter I With Breve
  s := StringReplace(s, #196#174, #73);          // Latin Capital Letter I With Ogonek
  s := StringReplace(s, #196#175, #105);         // Latin Small Letter I With Ogonek
  s := StringReplace(s, #196#176, #73);          // Latin Capital Letter I With Dot Above
  s := StringReplace(s, #196#177, #105);         // Latin Small Letter Dotless I
  s := StringReplace(s, #196#180, #74);          // Latin Capital Letter J With Circumflex
  s := StringReplace(s, #196#181, #106);         // Latin Small Letter J With Circumflex
  s := StringReplace(s, #196#182, #75);          // Latin Capital Letter K With Cedilla
  s := StringReplace(s, #196#183, #107);         // Latin Small Letter K With Cedilla
  s := StringReplace(s, #196#185, #197);         // Latin Capital Letter L With Acute
  s := StringReplace(s, #196#186, #229);         // Latin Small Letter L With Acute
  s := StringReplace(s, #196#187, #76);          // Latin Capital Letter L With Cedilla
  s := StringReplace(s, #196#188, #108);         // Latin Small Letter L With Cedilla
  s := StringReplace(s, #196#189, #188);         // Latin Capital Letter L With Caron
  s := StringReplace(s, #196#190, #190);         // Latin Small Letter L With Caron
  s := StringReplace(s, #197#129, #163);         // Latin Capital Letter L With Stroke
  s := StringReplace(s, #197#130, #179);         // Latin Small Letter L With Stroke
  s := StringReplace(s, #197#131, #209);         // Latin Capital Letter N With Acute
  s := StringReplace(s, #197#132, #241);         // Latin Small Letter N With Acute
  s := StringReplace(s, #197#133, #78);          // Latin Capital Letter N With Cedilla
  s := StringReplace(s, #197#134, #110);         // Latin Small Letter N With Cedilla
  s := StringReplace(s, #197#135, #210);         // Latin Capital Letter N With Caron
  s := StringReplace(s, #197#136, #242);         // Latin Small Letter N With Caron
  s := StringReplace(s, #197#140, #79);          // Latin Capital Letter O With Macron
  s := StringReplace(s, #197#141, #111);         // Latin Small Letter O With Macron
  s := StringReplace(s, #197#142, #79);          // Latin Capital Letter O With Breve
  s := StringReplace(s, #197#143, #111);         // Latin Small Letter O With Breve
  s := StringReplace(s, #197#144, #213);         // Latin Capital Letter O With Double Acute
  s := StringReplace(s, #197#145, #245);         // Latin Small Letter O With Double Acute
  s := StringReplace(s, #197#146, #79);          // Latin Capital Ligature Oe
  s := StringReplace(s, #197#147, #111);         // Latin Small Ligature Oe
  s := StringReplace(s, #197#148, #192);         // Latin Capital Letter R With Acute
  s := StringReplace(s, #197#149, #224);         // Latin Small Letter R With Acute
  s := StringReplace(s, #197#150, #82);          // Latin Capital Letter R With Cedilla
  s := StringReplace(s, #197#151, #114);         // Latin Small Letter R With Cedilla
  s := StringReplace(s, #197#152, #216);         // Latin Capital Letter R With Caron
  s := StringReplace(s, #197#153, #248);         // Latin Small Letter R With Caron
  s := StringReplace(s, #197#154, #140);         // Latin Capital Letter S With Acute
  s := StringReplace(s, #197#155, #156);         // Latin Small Letter S With Acute
  s := StringReplace(s, #197#156, #83);          // Latin Capital Letter S With Circumflex
  s := StringReplace(s, #197#157, #115);         // Latin Small Letter S With Circumflex
  s := StringReplace(s, #197#158, #170);         // Latin Capital Letter S With Cedilla
  s := StringReplace(s, #197#159, #186);         // Latin Small Letter S With Cedilla
  s := StringReplace(s, #197#160, #138);         // Latin Capital Letter S With Caron
  s := StringReplace(s, #197#161, #154);         // Latin Small Letter S With Caron
  s := StringReplace(s, #197#162, #222);         // Latin Capital Letter T With Cedilla
  s := StringReplace(s, #197#163, #254);         // Latin Small Letter T With Cedilla
  s := StringReplace(s, #197#164, #141);         // Latin Capital Letter T With Caron
  s := StringReplace(s, #197#165, #157);         // Latin Small Letter T With Caron
  s := StringReplace(s, #197#166, #84);          // Latin Capital Letter T With Stroke
  s := StringReplace(s, #197#167, #116);         // Latin Small Letter T With Stroke
  s := StringReplace(s, #197#168, #85);          // Latin Capital Letter U With Tilde
  s := StringReplace(s, #197#169, #117);         // Latin Small Letter U With Tilde
  s := StringReplace(s, #197#170, #85);          // Latin Capital Letter U With Macron
  s := StringReplace(s, #197#171, #117);         // Latin Small Letter U With Macron
  s := StringReplace(s, #197#172, #85);          // Latin Capital Letter U With Breve
  s := StringReplace(s, #197#173, #117);         // Latin Small Letter U With Breve
  s := StringReplace(s, #197#174, #217);         // Latin Capital Letter U With Ring Above
  s := StringReplace(s, #197#175, #249);         // Latin Small Letter U With Ring Above
  s := StringReplace(s, #197#176, #219);         // Latin Capital Letter U With Double Acute
  s := StringReplace(s, #197#177, #251);         // Latin Small Letter U With Double Acute
  s := StringReplace(s, #197#178, #85);          // Latin Capital Letter U With Ogonek
  s := StringReplace(s, #197#179, #117);         // Latin Small Letter U With Ogonek
  s := StringReplace(s, #197#180, #87);          // Latin Capital Letter W With Circumflex
  s := StringReplace(s, #197#181, #119);         // Latin Small Letter W With Circumflex
  s := StringReplace(s, #197#182, #89);          // Latin Capital Letter Y With Circumflex
  s := StringReplace(s, #197#183, #121);         // Latin Small Letter Y With Circumflex
  s := StringReplace(s, #197#184, #89);          // Latin Capital Letter Y With Diaeresis
  s := StringReplace(s, #197#185, #143);         // Latin Capital Letter Z With Acute
  s := StringReplace(s, #197#186, #159);         // Latin Small Letter Z With Acute
  s := StringReplace(s, #197#187, #175);         // Latin Capital Letter Z With Dot Above
  s := StringReplace(s, #197#188, #191);         // Latin Small Letter Z With Dot Above
  s := StringReplace(s, #197#189, #142);         // Latin Capital Letter Z With Caron
  s := StringReplace(s, #197#190, #158);         // Latin Small Letter Z With Caron
  s := StringReplace(s, #198#128, #98);          // Latin Small Letter B With Stroke
  s := StringReplace(s, #198#137, #208);         // Latin Capital Letter African D
  s := StringReplace(s, #198#145, #70);          // Latin Capital Letter F With Hook
  s := StringReplace(s, #198#146, #102);         // Latin Small Letter F With Hook
  s := StringReplace(s, #198#151, #73);          // Latin Capital Letter I With Stroke
  s := StringReplace(s, #198#154, #108);         // Latin Small Letter L With Bar
  s := StringReplace(s, #198#159, #79);          // Latin Capital Letter O With Middle Tilde
  s := StringReplace(s, #198#160, #79);          // Latin Capital Letter O With Horn
  s := StringReplace(s, #198#161, #111);         // Latin Small Letter O With Horn
  s := StringReplace(s, #198#171, #116);         // Latin Small Letter T With Palatal Hook
  s := StringReplace(s, #198#174, #84);          // Latin Capital Letter T With Retroflex Hook
  s := StringReplace(s, #198#175, #85);          // Latin Capital Letter U With Horn
  s := StringReplace(s, #198#176, #117);         // Latin Small Letter U With Horn
  s := StringReplace(s, #198#182, #122);         // Latin Small Letter Z With Stroke
  s := StringReplace(s, #199#128, #124);         // Latin Letter Dental Click
  s := StringReplace(s, #199#131, #33);          // Latin Letter Retroflex Click
  s := StringReplace(s, #199#141, #65);          // Latin Capital Letter A With Caron
  s := StringReplace(s, #199#142, #97);          // Latin Small Letter A With Caron
  s := StringReplace(s, #199#143, #73);          // Latin Capital Letter I With Caron
  s := StringReplace(s, #199#144, #105);         // Latin Small Letter I With Caron
  s := StringReplace(s, #199#145, #79);          // Latin Capital Letter O With Caron
  s := StringReplace(s, #199#146, #111);         // Latin Small Letter O With Caron
  s := StringReplace(s, #199#147, #85);          // Latin Capital Letter U With Caron
  s := StringReplace(s, #199#148, #117);         // Latin Small Letter U With Caron
  s := StringReplace(s, #199#149, #85);          // Latin Capital Letter U With Diaeresis And Macron
  s := StringReplace(s, #199#150, #117);         // Latin Small Letter U With Diaeresis And Macron
  s := StringReplace(s, #199#151, #85);          // Latin Capital Letter U With Diaeresis And Acute
  s := StringReplace(s, #199#152, #117);         // Latin Small Letter U With Diaeresis And Acute
  s := StringReplace(s, #199#153, #85);          // Latin Capital Letter U With Diaeresis And Caron
  s := StringReplace(s, #199#154, #117);         // Latin Small Letter U With Diaeresis And Caron
  s := StringReplace(s, #199#155, #85);          // Latin Capital Letter U With Diaeresis And Grave
  s := StringReplace(s, #199#156, #117);         // Latin Small Letter U With Diaeresis And Grave
  s := StringReplace(s, #199#158, #65);          // Latin Capital Letter A With Diaeresis And Macron
  s := StringReplace(s, #199#159, #97);          // Latin Small Letter A With Diaeresis And Macron
  s := StringReplace(s, #199#164, #71);          // Latin Capital Letter G With Stroke
  s := StringReplace(s, #199#165, #103);         // Latin Small Letter G With Stroke
  s := StringReplace(s, #199#166, #71);          // Latin Capital Letter G With Caron
  s := StringReplace(s, #199#167, #103);         // Latin Small Letter G With Caron
  s := StringReplace(s, #199#168, #75);          // Latin Capital Letter K With Caron
  s := StringReplace(s, #199#169, #107);         // Latin Small Letter K With Caron
  s := StringReplace(s, #199#170, #79);          // Latin Capital Letter O With Ogonek
  s := StringReplace(s, #199#171, #111);         // Latin Small Letter O With Ogonek
  s := StringReplace(s, #199#172, #79);          // Latin Capital Letter O With Ogonek And Macron
  s := StringReplace(s, #199#173, #111);         // Latin Small Letter O With Ogonek And Macron
  s := StringReplace(s, #199#176, #106);         // Latin Small Letter J With Caron
  s := StringReplace(s, #201#161, #103);         // Latin Small Letter Script G
  s := StringReplace(s, #202#185, #39);          // Modifier Letter Prime
  s := StringReplace(s, #202#186, #34);          // Modifier Letter Double Prime
  s := StringReplace(s, #202#187, #145);         // Modifier Letter Turned Comma
  s := StringReplace(s, #202#188, #39);          // Modifier Letter Apostrophe
  s := StringReplace(s, #203#132, #94);          // Modifier Letter Up Arrowhead
  s := StringReplace(s, #203#134, #94);          // Modifier Letter Circumflex Accent
  s := StringReplace(s, #203#135, #161);         // Caron
  s := StringReplace(s, #203#136, #39);          // Modifier Letter Vertical Line
  s := StringReplace(s, #203#137, #175);         // Modifier Letter Macron
  s := StringReplace(s, #203#138, #180);         // Modifier Letter Acute Accent
  s := StringReplace(s, #203#139, #96);          // Modifier Letter Grave Accent
  s := StringReplace(s, #203#141, #95);          // Modifier Letter Low Macron
  s := StringReplace(s, #203#152, #162);         // Breve
  s := StringReplace(s, #203#153, #255);         // Dot Above
  s := StringReplace(s, #203#154, #176);         // Ring Above
  s := StringReplace(s, #203#155, #178);         // Ogonek
  s := StringReplace(s, #203#156, #126);         // Small Tilde
  s := StringReplace(s, #203#157, #189);         // Double Acute Accent
  s := StringReplace(s, #204#128, #96);          // Combining Grave Accent
  s := StringReplace(s, #204#129, #180);         // Combining Acute Accent
  s := StringReplace(s, #204#130, #94);          // Combining Circumflex Accent
  s := StringReplace(s, #204#131, #126);         // Combining Tilde
  s := StringReplace(s, #204#132, #175);         // Combining Macron
  s := StringReplace(s, #204#133, #175);         // Combining Overline
  s := StringReplace(s, #204#134, #162);         // Combining Breve
  s := StringReplace(s, #204#135, #255);         // Combining Dot Above
  s := StringReplace(s, #204#136, #168);         // Combining Diaeresis
  s := StringReplace(s, #204#138, #176);         // Combining Ring Above
  s := StringReplace(s, #204#140, #161);         // Combining Caron
  s := StringReplace(s, #204#142, #34);          // Combining Double Vertical Line Above
  s := StringReplace(s, #204#167, #184);         // Combining Cedilla
  s := StringReplace(s, #204#177, #95);          // Combining Macron Below
  s := StringReplace(s, #204#178, #95);          // Combining Low Line
  s := StringReplace(s, #205#190, #59);          // Greek Question Mark
  s := StringReplace(s, #206#178, #223);         // Greek Small Letter Beta
  s := StringReplace(s, #206#188, #181);         // Greek Small Letter Mu
  s := StringReplace(s, #210#187, #104);         // Cyrillic Small Letter Shha
  s := StringReplace(s, #214#137, #58);          // Armenian Full Stop
  s := StringReplace(s, #217#170, #37);          // Arabic Percent Sign
  s := StringReplace(s, #226#128#128, #32);      // En Quad
  s := StringReplace(s, #226#128#129, #32);      // Em Quad
  s := StringReplace(s, #226#128#130, #32);      // En Space
  s := StringReplace(s, #226#128#131, #32);      // Em Space
  s := StringReplace(s, #226#128#132, #32);      // Three-Per-Em Space
  s := StringReplace(s, #226#128#133, #32);      // Four-Per-Em Space
  s := StringReplace(s, #226#128#134, #32);      // Six-Per-Em Space
  s := StringReplace(s, #226#128#144, #45);      // Hyphen
  s := StringReplace(s, #226#128#145, #45);      // Non-Breaking Hyphen
  s := StringReplace(s, #226#128#147, #150);     // En Dash
  s := StringReplace(s, #226#128#148, #151);     // Em Dash
  s := StringReplace(s, #226#128#152, #145);     // Left Single Quotation Mark
  s := StringReplace(s, #226#128#153, #146);     // Right Single Quotation Mark
  s := StringReplace(s, #226#128#154, #130);     // Single Low-9 Quotation Mark
  s := StringReplace(s, #226#128#156, #147);     // Left Double Quotation Mark
  s := StringReplace(s, #226#128#157, #148);     // Right Double Quotation Mark
  s := StringReplace(s, #226#128#158, #132);     // Double Low-9 Quotation Mark
  s := StringReplace(s, #226#128#160, #134);     // Dagger
  s := StringReplace(s, #226#128#161, #135);     // Double Dagger
  s := StringReplace(s, #226#128#162, #149);     // Bullet
  s := StringReplace(s, #226#128#164, #149);     // One Dot Leader
  s := StringReplace(s, #226#128#166, #133);     // Horizontal Ellipsis
  s := StringReplace(s, #226#128#176, #137);     // Per Mille Sign
  s := StringReplace(s, #226#128#178, #39);      // Prime
  s := StringReplace(s, #226#128#179, #148);     // Double Prime
  s := StringReplace(s, #226#128#181, #96);      // Reversed Prime
  s := StringReplace(s, #226#128#185, #139);     // Single Left-Pointing Angle Quotation Mark
  s := StringReplace(s, #226#128#186, #155);     // Single Right-Pointing Angle Quotation Mark
  s := StringReplace(s, #226#128#188, #33);      // Double Exclamation Mark
  s := StringReplace(s, #226#129#132, #47);      // Fraction Slash
  s := StringReplace(s, #226#129#176, #176);     // Superscript Zero
  s := StringReplace(s, #226#129#180, #52);      // Superscript Four
  s := StringReplace(s, #226#129#181, #53);      // Superscript Five
  s := StringReplace(s, #226#129#182, #54);      // Superscript Six
  s := StringReplace(s, #226#129#183, #55);      // Superscript Seven
  s := StringReplace(s, #226#129#184, #56);      // Superscript Eight
  s := StringReplace(s, #226#130#128, #48);      // Subscript Zero
  s := StringReplace(s, #226#130#129, #49);      // Subscript One
  s := StringReplace(s, #226#130#130, #50);      // Subscript Two
  s := StringReplace(s, #226#130#131, #51);      // Subscript Three
  s := StringReplace(s, #226#130#132, #52);      // Subscript Four
  s := StringReplace(s, #226#130#133, #53);      // Subscript Five
  s := StringReplace(s, #226#130#134, #54);      // Subscript Six
  s := StringReplace(s, #226#130#135, #55);      // Subscript Seven
  s := StringReplace(s, #226#130#136, #56);      // Subscript Eight
  s := StringReplace(s, #226#130#137, #57);      // Subscript Nine
  s := StringReplace(s, #226#130#172, #128);     // Euro Sign
  s := StringReplace(s, #226#130#164, #163);     // Lira Sign
  s := StringReplace(s, #226#132#130, #67);      // Double-Struck Capital C
  s := StringReplace(s, #226#132#135, #69);      // Euler Constant
  s := StringReplace(s, #226#132#138, #103);     // Script Small G
  s := StringReplace(s, #226#132#139, #72);      // Script Capital H
  s := StringReplace(s, #226#132#140, #72);      // Black-Letter Capital H
  s := StringReplace(s, #226#132#141, #72);      // Double-Struck Capital H
  s := StringReplace(s, #226#132#142, #104);     // Planck Constant
  s := StringReplace(s, #226#132#144, #73);      // Script Capital I
  s := StringReplace(s, #226#132#145, #73);      // Black-Letter Capital I
  s := StringReplace(s, #226#132#146, #76);      // Script Capital L
  s := StringReplace(s, #226#132#147, #108);     // Script Small L
  s := StringReplace(s, #226#132#149, #78);      // Double-Struck Capital N
  s := StringReplace(s, #226#132#152, #80);      // Script Capital P
  s := StringReplace(s, #226#132#153, #80);      // Double-Struck Capital P
  s := StringReplace(s, #226#132#154, #81);      // Double-Struck Capital Q
  s := StringReplace(s, #226#132#155, #82);      // Script Capital R
  s := StringReplace(s, #226#132#156, #82);      // Black-Letter Capital R
  s := StringReplace(s, #226#132#157, #82);      // Double-Struck Capital R
  s := StringReplace(s, #226#132#162, #153);     // Trade Mark Sign
  s := StringReplace(s, #226#132#164, #90);      // Double-Struck Capital Z
  s := StringReplace(s, #226#132#168, #90);      // Black-Letter Capital Z
  s := StringReplace(s, #226#132#170, #75);      // Kelvin Sign
  s := StringReplace(s, #226#132#171, #197);     // Angstrom Sign
  s := StringReplace(s, #226#132#172, #66);      // Script Capital B
  s := StringReplace(s, #226#132#173, #67);      // Black-Letter Capital C
  s := StringReplace(s, #226#132#174, #101);     // Estimated Symbol
  s := StringReplace(s, #226#132#175, #101);     // Script Small E
  s := StringReplace(s, #226#132#176, #69);      // Script Capital E
  s := StringReplace(s, #226#132#177, #70);      // Script Capital F
  s := StringReplace(s, #226#132#179, #77);      // Script Capital M
  s := StringReplace(s, #226#132#180, #111);     // Script Small O
  s := StringReplace(s, #226#134#144, #139);     // Leftwards Arrow
  s := StringReplace(s, #226#134#145, #94);      // Upwards Arrow
  s := StringReplace(s, #226#134#146, #155);     // Rightwards Arrow
  s := StringReplace(s, #226#134#147, #161);     // Downwards Arrow
  s := StringReplace(s, #226#134#148, #45);      // Left Right Arrow
  s := StringReplace(s, #226#134#149, #124);     // Up Down Arrow
  s := StringReplace(s, #226#134#168, #124);     // Up Down Arrow With Base
  s := StringReplace(s, #226#136#133, #216);     // Empty Set
  s := StringReplace(s, #226#136#146, #45);      // Minus Sign
  s := StringReplace(s, #226#136#147, #177);     // Minus-Or-Plus Sign
  s := StringReplace(s, #226#136#149, #47);      // Division Slash
  s := StringReplace(s, #226#136#150, #92);      // Set Minus
  s := StringReplace(s, #226#136#151, #42);      // Asterisk Operator
  s := StringReplace(s, #226#136#152, #176);     // Ring Operator
  s := StringReplace(s, #226#136#153, #149);     // Bullet Operator
  s := StringReplace(s, #226#136#159, #76);      // Right Angle
  s := StringReplace(s, #226#136#163, #124);     // Divides
  s := StringReplace(s, #226#136#182, #58);      // Ratio
  s := StringReplace(s, #226#136#188, #126);     // Tilde Operator
  s := StringReplace(s, #226#137#170, #171);     // Much Less-Than
  s := StringReplace(s, #226#137#171, #187);     // Much Greater-Than
  s := StringReplace(s, #226#139#133, #183);     // Dot Operator
  s := StringReplace(s, #226#140#130, #166);     // House
  s := StringReplace(s, #226#140#131, #94);      // Up Arrowhead
  s := StringReplace(s, #226#140#169, #60);      // Left-Pointing Angle Bracket
  s := StringReplace(s, #226#140#170, #62);      // Right-Pointing Angle Bracket
  s := StringReplace(s, #226#148#128, #166);     // Box Drawings Light Horizontal
  s := StringReplace(s, #226#148#130, #45);      // Box Drawings Light Vertical
  s := StringReplace(s, #226#148#140, #45);      // Box Drawings Light Down And Right
  s := StringReplace(s, #226#148#144, #172);     // Box Drawings Light Down And Left
  s := StringReplace(s, #226#148#148, #76);      // Box Drawings Light Up And Right
  s := StringReplace(s, #226#148#152, #45);      // Box Drawings Light Up And Left
  s := StringReplace(s, #226#148#156, #43);      // Box Drawings Light Vertical And Right
  s := StringReplace(s, #226#148#164, #43);      // Box Drawings Light Vertical And Left
  s := StringReplace(s, #226#148#172, #84);      // Box Drawings Light Down And Horizontal
  s := StringReplace(s, #226#148#180, #43);      // Box Drawings Light Up And Horizontal
  s := StringReplace(s, #226#148#188, #43);      // Box Drawings Light Vertical And Horizontal
  s := StringReplace(s, #226#149#144, #61);      // Box Drawings Double Horizontal
  s := StringReplace(s, #226#149#145, #166);     // Box Drawings Double Vertical
  s := StringReplace(s, #226#149#148, #45);      // Box Drawings Double Down And Right
  s := StringReplace(s, #226#149#151, #172);     // Box Drawings Double Down And Left
  s := StringReplace(s, #226#149#154, #76);      // Box Drawings Double Up And Right
  s := StringReplace(s, #226#149#157, #45);      // Box Drawings Double Up And Left
  s := StringReplace(s, #226#149#160, #166);     // Box Drawings Double Vertical And Right
  s := StringReplace(s, #226#149#163, #166);     // Box Drawings Double Vertical And Left
  s := StringReplace(s, #226#149#166, #84);      // Box Drawings Double Down And Horizontal
  s := StringReplace(s, #226#149#169, #166);     // Box Drawings Double Up And Horizontal
  s := StringReplace(s, #226#149#172, #43);      // Box Drawings Double Vertical And Horizontal
  s := StringReplace(s, #226#150#128, #45);      // Upper Half Block
  s := StringReplace(s, #226#150#132, #45);      // Lower Half Block
  s := StringReplace(s, #226#150#136, #45);      // Full Block
  s := StringReplace(s, #226#150#145, #45);      // Light Shade
  s := StringReplace(s, #226#150#146, #45);      // Medium Shade
  s := StringReplace(s, #226#150#147, #45);      // Dark Shade
  s := StringReplace(s, #226#150#160, #166);     // Black Square
  s := StringReplace(s, #226#150#172, #45);      // Black Rectangle
  s := StringReplace(s, #226#150#178, #94);      // Black Up-Pointing Triangle
  s := StringReplace(s, #226#150#186, #62);      // Black Right-Pointing Pointer
  s := StringReplace(s, #226#150#188, #161);     // Black Down-Pointing Triangle
  s := StringReplace(s, #226#151#132, #60);      // Black Left-Pointing Pointer
  s := StringReplace(s, #226#151#139, #48);      // White Circle
  s := StringReplace(s, #226#151#152, #149);     // Inverse Bullet
  s := StringReplace(s, #226#151#153, #48);      // Inverse White Circle
  s := StringReplace(s, #226#152#186, #162);     // White Smiling Face
  s := StringReplace(s, #226#152#187, #162);     // Black Smiling Face
  s := StringReplace(s, #226#152#188, #48);      // White Sun With Rays
  s := StringReplace(s, #226#153#128, #43);      // Female Sign
  s := StringReplace(s, #226#153#130, #62);      // Male Sign
  s := StringReplace(s, #226#153#160, #166);     // Black Spade Suit
  s := StringReplace(s, #226#153#163, #166);     // Black Club Suit
  s := StringReplace(s, #226#153#165, #166);     // Black Heart Suit
  s := StringReplace(s, #226#153#166, #166);     // Black Diamond Suit
  s := StringReplace(s, #226#153#170, #100);     // Eighth Note
  s := StringReplace(s, #226#153#171, #100);     // Beamed Eighth Notes
  s := StringReplace(s, #226#157#152, #124);     // Light Vertical Bar
  s := StringReplace(s, #226#157#155, #145);     // Heavy Single Turned Comma Quotation Mark Ornament
  s := StringReplace(s, #226#157#156, #146);     // Heavy Single Comma Quotation Mark Ornament
  s := StringReplace(s, #226#157#157, #147);     // Heavy Double Turned Comma Quotation Mark Ornament
  s := StringReplace(s, #226#157#158, #148);     // Heavy Double Comma Quotation Mark Ornament
  s := StringReplace(s, #227#128#128, #32);      // Ideographic Space
  s := StringReplace(s, #227#128#136, #60);      // Left Angle Bracket
  s := StringReplace(s, #227#128#137, #62);      // Right Angle Bracket
  s := StringReplace(s, #227#128#138, #171);     // Left Double Angle Bracket
  s := StringReplace(s, #227#128#139, #187);     // Right Double Angle Bracket
  s := StringReplace(s, #227#128#154, #91);      // Left White Square Bracket
  s := StringReplace(s, #227#128#155, #93);      // Right White Square Bracket
  s := StringReplace(s, #227#128#157, #147);     // Reversed Double Prime Quotation Mark
  s := StringReplace(s, #227#128#158, #148);     // Double Prime Quotation Mark
  s := StringReplace(s, #227#128#159, #132);     // Low Double Prime Quotation Mark
  s := StringReplace(s, #227#131#187, #183);     // Katakana Middle Dot
  s := StringReplace(s, #227#131#188, #151);     // Katakana-Hiragana Prolonged Sound Mark
  s := StringReplace(s, #239#188#129, #33);      // Fullwidth Exclamation Mark
  s := StringReplace(s, #239#188#130, #34);      // Fullwidth Quotation Mark
  s := StringReplace(s, #239#188#131, #35);      // Fullwidth Number Sign
  s := StringReplace(s, #239#188#132, #36);      // Fullwidth Dollar Sign
  s := StringReplace(s, #239#188#133, #37);      // Fullwidth Percent Sign
  s := StringReplace(s, #239#188#134, #38);      // Fullwidth Ampersand
  s := StringReplace(s, #239#188#135, #39);      // Fullwidth Apostrophe
  s := StringReplace(s, #239#188#136, #40);      // Fullwidth Left Parenthesis
  s := StringReplace(s, #239#188#137, #41);      // Fullwidth Right Parenthesis
  s := StringReplace(s, #239#188#138, #42);      // Fullwidth Asterisk
  s := StringReplace(s, #239#188#139, #43);      // Fullwidth Plus Sign
  s := StringReplace(s, #239#188#140, #44);      // Fullwidth Comma
  s := StringReplace(s, #239#188#141, #45);      // Fullwidth Hyphen-Minus
  s := StringReplace(s, #239#188#142, #46);      // Fullwidth Full Stop
  s := StringReplace(s, #239#188#143, #47);      // Fullwidth Solidus
  s := StringReplace(s, #239#188#144, #48);      // Fullwidth Digit Zero
  s := StringReplace(s, #239#188#145, #49);      // Fullwidth Digit One
  s := StringReplace(s, #239#188#146, #50);      // Fullwidth Digit Two
  s := StringReplace(s, #239#188#147, #51);      // Fullwidth Digit Three
  s := StringReplace(s, #239#188#148, #52);      // Fullwidth Digit Four
  s := StringReplace(s, #239#188#149, #53);      // Fullwidth Digit Five
  s := StringReplace(s, #239#188#150, #54);      // Fullwidth Digit Six
  s := StringReplace(s, #239#188#151, #55);      // Fullwidth Digit Seven
  s := StringReplace(s, #239#188#152, #56);      // Fullwidth Digit Eight
  s := StringReplace(s, #239#188#153, #57);      // Fullwidth Digit Nine
  s := StringReplace(s, #239#188#154, #58);      // Fullwidth Colon
  s := StringReplace(s, #239#188#155, #59);      // Fullwidth Semicolon
  s := StringReplace(s, #239#188#156, #60);      // Fullwidth Less-Than Sign
  s := StringReplace(s, #239#188#157, #61);      // Fullwidth Equals Sign
  s := StringReplace(s, #239#188#158, #62);      // Fullwidth Greater-Than Sign
  s := StringReplace(s, #239#188#159, #63);      // Fullwidth Question Mark
  s := StringReplace(s, #239#188#160, #64);      // Fullwidth Commercial At
  s := StringReplace(s, #239#188#161, #65);      // Fullwidth Latin Capital Letter A
  s := StringReplace(s, #239#188#162, #66);      // Fullwidth Latin Capital Letter B
  s := StringReplace(s, #239#188#163, #67);      // Fullwidth Latin Capital Letter C
  s := StringReplace(s, #239#188#164, #68);      // Fullwidth Latin Capital Letter D
  s := StringReplace(s, #239#188#165, #69);      // Fullwidth Latin Capital Letter E
  s := StringReplace(s, #239#188#166, #70);      // Fullwidth Latin Capital Letter F
  s := StringReplace(s, #239#188#167, #71);      // Fullwidth Latin Capital Letter G
  s := StringReplace(s, #239#188#168, #72);      // Fullwidth Latin Capital Letter H
  s := StringReplace(s, #239#188#169, #73);      // Fullwidth Latin Capital Letter I
  s := StringReplace(s, #239#188#170, #74);      // Fullwidth Latin Capital Letter J
  s := StringReplace(s, #239#188#171, #75);      // Fullwidth Latin Capital Letter K
  s := StringReplace(s, #239#188#172, #76);      // Fullwidth Latin Capital Letter L
  s := StringReplace(s, #239#188#173, #77);      // Fullwidth Latin Capital Letter M
  s := StringReplace(s, #239#188#174, #78);      // Fullwidth Latin Capital Letter N
  s := StringReplace(s, #239#188#175, #79);      // Fullwidth Latin Capital Letter O
  s := StringReplace(s, #239#188#176, #80);      // Fullwidth Latin Capital Letter P
  s := StringReplace(s, #239#188#177, #81);      // Fullwidth Latin Capital Letter Q
  s := StringReplace(s, #239#188#178, #82);      // Fullwidth Latin Capital Letter R
  s := StringReplace(s, #239#188#179, #83);      // Fullwidth Latin Capital Letter S
  s := StringReplace(s, #239#188#180, #84);      // Fullwidth Latin Capital Letter T
  s := StringReplace(s, #239#188#181, #85);      // Fullwidth Latin Capital Letter U
  s := StringReplace(s, #239#188#182, #86);      // Fullwidth Latin Capital Letter V
  s := StringReplace(s, #239#188#183, #87);      // Fullwidth Latin Capital Letter W
  s := StringReplace(s, #239#188#184, #88);      // Fullwidth Latin Capital Letter X
  s := StringReplace(s, #239#188#185, #89);      // Fullwidth Latin Capital Letter Y
  s := StringReplace(s, #239#188#186, #90);      // Fullwidth Latin Capital Letter Z
  s := StringReplace(s, #239#188#187, #91);      // Fullwidth Left Square Bracket
  s := StringReplace(s, #239#188#188, #92);      // Fullwidth Reverse Solidus
  s := StringReplace(s, #239#188#189, #93);      // Fullwidth Right Square Bracket
  s := StringReplace(s, #239#188#190, #94);      // Fullwidth Circumflex Accent
  s := StringReplace(s, #239#188#191, #95);      // Fullwidth Low Line
  s := StringReplace(s, #239#189#128, #96);      // Fullwidth Grave Accent
  s := StringReplace(s, #239#189#129, #97);      // Fullwidth Latin Small Letter A
  s := StringReplace(s, #239#189#130, #98);      // Fullwidth Latin Small Letter B
  s := StringReplace(s, #239#189#131, #99);      // Fullwidth Latin Small Letter C
  s := StringReplace(s, #239#189#132, #100);     // Fullwidth Latin Small Letter D
  s := StringReplace(s, #239#189#133, #101);     // Fullwidth Latin Small Letter E
  s := StringReplace(s, #239#189#134, #102);     // Fullwidth Latin Small Letter F
  s := StringReplace(s, #239#189#135, #103);     // Fullwidth Latin Small Letter G
  s := StringReplace(s, #239#189#136, #104);     // Fullwidth Latin Small Letter H
  s := StringReplace(s, #239#189#137, #105);     // Fullwidth Latin Small Letter I
  s := StringReplace(s, #239#189#138, #106);     // Fullwidth Latin Small Letter J
  s := StringReplace(s, #239#189#139, #107);     // Fullwidth Latin Small Letter K
  s := StringReplace(s, #239#189#140, #108);     // Fullwidth Latin Small Letter L
  s := StringReplace(s, #239#189#141, #109);     // Fullwidth Latin Small Letter M
  s := StringReplace(s, #239#189#142, #110);     // Fullwidth Latin Small Letter N
  s := StringReplace(s, #239#189#143, #111);     // Fullwidth Latin Small Letter O
  s := StringReplace(s, #239#189#144, #112);     // Fullwidth Latin Small Letter P
  s := StringReplace(s, #239#189#145, #113);     // Fullwidth Latin Small Letter Q
  s := StringReplace(s, #239#189#146, #114);     // Fullwidth Latin Small Letter R
  s := StringReplace(s, #239#189#147, #115);     // Fullwidth Latin Small Letter S
  s := StringReplace(s, #239#189#148, #116);     // Fullwidth Latin Small Letter T
  s := StringReplace(s, #239#189#149, #117);     // Fullwidth Latin Small Letter U
  s := StringReplace(s, #239#189#150, #118);     // Fullwidth Latin Small Letter V
  s := StringReplace(s, #239#189#151, #119);     // Fullwidth Latin Small Letter W
  s := StringReplace(s, #239#189#152, #120);     // Fullwidth Latin Small Letter X
  s := StringReplace(s, #239#189#153, #121);     // Fullwidth Latin Small Letter Y
  s := StringReplace(s, #239#189#154, #122);     // Fullwidth Latin Small Letter Z
  s := StringReplace(s, #239#189#155, #123);     // Fullwidth Left Curly Bracket
  s := StringReplace(s, #239#189#156, #124);     // Fullwidth Vertical Line
  s := StringReplace(s, #239#189#157, #125);     // Fullwidth Right Curly Bracket
  s := StringReplace(s, #239#189#158, #126);     // Fullwidth Tilde
  //result := UTF8Decode(s);
  result := s;
end;

function SubCharCP1250ToUTF8(SrcStr: string; var CharPos: integer): string;
var oldval, newval: string;
begin
  oldval := copy(SrcStr, CharPos, 1);
  case oldval of
    #128: newval := #226#130#172;     // Euro Sign  
    #129: newval := #194#129;         // <control>
    #130: newval := #226#128#154;     // Single Low-9 Quotation Mark
    #131: newval := #194#131;         // <control>
    #132: newval := #226#128#158;     // Double Low-9 Quotation Mark
    #133: newval := #226#128#166;     // Horizontal Ellipsis
    #134: newval := #226#128#160;     // Dagger
    #135: newval := #226#128#161;     // Double Dagger
    #136: newval := #194#136;         // <control>
    #137: newval := #226#128#176;     // Per Mille Sign
    #138: newval := #197#160;         // Latin Capital Letter S With Caron
    #139: newval := #226#128#185;     // Single Left-Pointing Angle Quotation Mark
    #140: newval := #197#154;         // Latin Capital Letter S With Acute
    #141: newval := #197#164;         // Latin Capital Letter T With Caron
    #142: newval := #197#189;         // Latin Capital Letter Z With Caron
    #143: newval := #197#185;         // Latin Capital Letter Z With Acute
    #144: newval := #194#144;         // <control>
    #145: newval := #226#128#152;     // Left Single Quotation Mark
    #146: newval := #226#128#153;     // Right Single Quotation Mark
    #147: newval := #226#128#156;     // Left Double Quotation Mark
    #148: newval := #226#128#157;     // Right Double Quotation Mark
    #149: newval := #226#128#162;     // Bullet
    #150: newval := #226#128#147;     // En Dash
    #151: newval := #226#128#148;     // Em Dash
    #152: newval := #194#152;         // <control>
    #153: newval := #226#132#162;     // Trade Mark Sign
    #154: newval := #197#161;         // Latin Small Letter S With Caron
    #155: newval := #226#128#186;     // Single Right-Pointing Angle Quotation Mark
    #156: newval := #197#155;         // Latin Small Letter S With Acute
    #157: newval := #197#165;         // Latin Small Letter T With Caron
    #158: newval := #197#190;         // Latin Small Letter Z With Caron
    #159: newval := #197#186;         // Latin Small Letter Z With Acute
    #160: newval := #194#160;         // No-Break Space
    #161: newval := #203#135;         // Caron
    #162: newval := #203#152;         // Breve
    #163: newval := #197#129;         // Latin Capital Letter L With Stroke
    #164: newval := #194#164;         // Currency Sign
    #165: newval := #196#132;         // Latin Capital Letter A With Ogonek
    #166: newval := #194#166;         // Broken Bar
    #167: newval := #194#167;         // Section Sign
    #168: newval := #194#168;         // Diaeresis
    #169: newval := #194#169;         // Copyright Sign
    #170: newval := #197#158;         // Latin Capital Letter S With Cedilla
    #171: newval := #194#171;         // Left-Pointing Double Angle Quotation Mark
    #172: newval := #194#172;         // Not Sign
    #173: newval := #194#173;         // Soft Hyphen
    #174: newval := #194#174;         // Registered Sign
    #175: newval := #197#187;         // Latin Capital Letter Z With Dot Above
    #176: newval := #194#176;         // Degree Sign
    #177: newval := #194#177;         // Plus-Minus Sign
    #178: newval := #203#155;         // Ogonek
    #179: newval := #197#130;         // Latin Small Letter L With Stroke
    #180: newval := #194#180;         // Acute Accent
    #181: newval := #194#181;         // Micro Sign
    #182: newval := #194#182;         // Pilcrow Sign
    #183: newval := #194#183;         // Middle Dot
    #184: newval := #194#184;         // Cedilla
    #185: newval := #196#133;         // Latin Small Letter A With Ogonek
    #186: newval := #197#159;         // Latin Small Letter S With Cedilla
    #187: newval := #194#187;         // Right-Pointing Double Angle Quotation Mark
    #188: newval := #196#189;         // Latin Capital Letter L With Caron
    #189: newval := #203#157;         // Double Acute Accent
    #190: newval := #196#190;         // Latin Small Letter L With Caron
    #191: newval := #197#188;         // Latin Small Letter Z With Dot Above
    #192: newval := #197#148;         // Latin Capital Letter R With Acute
    #193: newval := #195#129;         // Latin Capital Letter A With Acute
    #194: newval := #195#130;         // Latin Capital Letter A With Circumflex
    #195: newval := #196#130;         // Latin Capital Letter A With Breve
    #196: newval := #195#132;         // Latin Capital Letter A With Diaeresis
    #197: newval := #196#185;         // Latin Capital Letter L With Acute
    #198: newval := #196#134;         // Latin Capital Letter C With Acute
    #199: newval := #195#135;         // Latin Capital Letter C With Cedilla
    #200: newval := #196#140;         // Latin Capital Letter C With Caron
    #201: newval := #195#137;         // Latin Capital Letter E With Acute
    #202: newval := #196#152;         // Latin Capital Letter E With Ogonek
    #203: newval := #195#139;         // Latin Capital Letter E With Diaeresis
    #204: newval := #196#154;         // Latin Capital Letter E With Caron
    #205: newval := #195#141;         // Latin Capital Letter I With Acute
    #206: newval := #195#142;         // Latin Capital Letter I With Circumflex
    #207: newval := #196#142;         // Latin Capital Letter D With Caron
    #208: newval := #196#144;         // Latin Capital Letter D With Stroke
    #209: newval := #197#131;         // Latin Capital Letter N With Acute
    #210: newval := #197#135;         // Latin Capital Letter N With Caron
    #211: newval := #195#147;         // Latin Capital Letter O With Acute
    #212: newval := #195#148;         // Latin Capital Letter O With Circumflex
    #213: newval := #197#144;         // Latin Capital Letter O With Double Acute
    #214: newval := #195#150;         // Latin Capital Letter O With Diaeresis
    #215: newval := #195#151;         // Multiplication Sign
    #216: newval := #197#152;         // Latin Capital Letter R With Caron
    #217: newval := #197#174;         // Latin Capital Letter U With Ring Above
    #218: newval := #195#154;         // Latin Capital Letter U With Acute
    #219: newval := #197#176;         // Latin Capital Letter U With Double Acute
    #220: newval := #195#156;         // Latin Capital Letter U With Diaeresis
    #221: newval := #195#157;         // Latin Capital Letter Y With Acute
    #222: newval := #197#162;         // Latin Capital Letter T With Cedilla
    #223: newval := #195#159;         // Latin Small Letter Sharp S
    #224: newval := #197#149;         // Latin Small Letter R With Acute
    #225: newval := #195#161;         // Latin Small Letter A With Acute
    #226: newval := #195#162;         // Latin Small Letter A With Circumflex
    #227: newval := #196#131;         // Latin Small Letter A With Breve
    #228: newval := #195#164;         // Latin Small Letter A With Diaeresis
    #229: newval := #196#186;         // Latin Small Letter L With Acute
    #230: newval := #196#135;         // Latin Small Letter C With Acute
    #231: newval := #195#167;         // Latin Small Letter C With Cedilla
    #232: newval := #196#141;         // Latin Small Letter C With Caron
    #233: newval := #195#169;         // Latin Small Letter E With Acute
    #234: newval := #196#153;         // Latin Small Letter E With Ogonek
    #235: newval := #195#171;         // Latin Small Letter E With Diaeresis
    #236: newval := #196#155;         // Latin Small Letter E With Caron
    #237: newval := #195#173;         // Latin Small Letter I With Acute
    #238: newval := #195#174;         // Latin Small Letter I With Circumflex
    #239: newval := #196#143;         // Latin Small Letter D With Caron
    #240: newval := #196#145;         // Latin Small Letter D With Stroke
    #241: newval := #197#132;         // Latin Small Letter N With Acute
    #242: newval := #197#136;         // Latin Small Letter N With Caron
    #243: newval := #195#179;         // Latin Small Letter O With Acute
    #244: newval := #195#180;         // Latin Small Letter O With Circumflex
    #245: newval := #197#145;         // Latin Small Letter O With Double Acute
    #246: newval := #195#182;         // Latin Small Letter O With Diaeresis
    #247: newval := #195#183;         // Division Sign
    #248: newval := #197#153;         // Latin Small Letter R With Caron
    #249: newval := #197#175;         // Latin Small Letter U With Ring Above
    #250: newval := #195#186;         // Latin Small Letter U With Acute
    #251: newval := #197#177;         // Latin Small Letter U With Double Acute
    #252: newval := #195#188;         // Latin Small Letter U With Diaeresis
    #253: newval := #195#189;         // Latin Small Letter Y With Acute
    #254: newval := #197#163;         // Latin Small Letter T With Cedilla
    #255: newval := #203#153;         // Dot Above
  else
    newval := oldval;
  end;
  result := copy(SrcStr, 1, CharPos-1) + newval + copy(SrcStr, CharPos+1, Length(SrcStr)-CharPos);
  CharPos := CharPos + Length(newval); // return next char position
end;

function CP1250ToUTF8(str: string): string;
var 
  s: string;
  i: integer;
  chpos: integer;
begin
  s := str;
  chpos := 1;
  for i:=0 to length(str)-1 do
    s := SubCharCP1250ToUTF8(s, chpos);
  result := s;
end;

begin
end.  